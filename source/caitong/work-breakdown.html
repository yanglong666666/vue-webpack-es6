---
title: 销售管理-产品预约
layout: default-iframe
---
<script src="../../javascript/select2.full.min.js"></script>
<script src="../javascript/jquery.ztree.all-3.5.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function () {
        // tab切换
        $(".main-content-wrap-top").on("click", ".tab-options", function () {
            var _this = $(this);
            var tabs_head = _this.parent();
            var tabs_body = tabs_head.siblings(".main-content-wrap-list");
            _this.addClass("on").siblings(".tab-options").removeClass("on");
            var index = tabs_head.find(".tab-options").index(_this);
            tabs_body.find(".search-content").eq(index).addClass("on").siblings(".search-content").removeClass("on");
            if ($('.search-content-change').hasClass('on')) {
                $('.search-content-change').parent('.main-content-wrap-list').siblings('.main-content-wrap-top').css({border: 'none'})

            } else {
                $('.search-content-change').parent('.main-content-wrap-list').siblings('.main-content-wrap-top').css({borderBottom: '1px solid #e5e5e5'})
            }
        });

        $('.btn-group').on('mouseover', function () {
            $(this).find('.sub-group').show();
        }).on('mouseout', function () {
            $(this).find('.sub-group').hide();
        });

        $('#select1').diySelect();
        $('#select2').diySelect();
        $('#select3').diySelect();
        $('#select4').diySelect();
        $('#select21').diySelect({width: 222});

        $(".select2").select2({width: 222});





        $(".tabs-items").on("click", ".tab-option", function () {
            var _this = $(this);
            var tabs_head = _this.parent();
            var tabs_body = tabs_head.nextAll(".dialog-item-box-body").children(".tabs-body");
            _this.addClass("on").siblings(".tab-option").removeClass("on");
            var index = tabs_head.find(".tab-option").index(_this);
            tabs_body.find(".tabs-content").eq(index).addClass("on").siblings(".tabs-content").removeClass("on");
            tabs_body.find(".tabs-content").eq(index).css({"display":"block"}).siblings('.tabs-content').css({"display":"none"})
        })

        $("#btn_add").click(function(){
            $(".main-content").hide();
            $(".edit-add").show();
        })
        $(".edit-add .view-back,#editBtnCancel").click(function(){
            $(".main-content").show();
            $(".edit-add").hide();
        })

        $(".btn-department").click(function(){
            $(".main-content").hide();
            $(".edit-department").show();
        })

        $(".edit-department .view-back ").click(function(){
            $(".main-content").show();
            $(".edit-department").hide();
        })

        $('#btnAdd').on('click',function(){
            var content = '<div class="addDialog"><div class="dialog-item-wrap">' +
                '<div class="dialog-item">' +
                '   <div class="dialog-left must-icon">新增分类</div>' +
                '   <div class="dialog-right">' +
                '       <label><input type="radio" checked="">分公司</label>' +
                '       <label><input type="radio" class="">营业部</label>' +
                '   </div>' +
                '</div>' +
                '<div class="dialog-item">' +
                '   <div class="dialog-left must-icon">名称</div>' +
                '   <div class="dialog-right">' +
                '       <input class="dialog-input" placeholder="">' +
                '   </div>' +
                '</div>' +
                '</div></div>';
            var dialog = new Dialog(null,{
                title: '标题',
                content: content,
                width: '360',
                needDestroy: true,
                hasBtn: true,
                btnText: ["取消","确定"],
                btnRole: ['cancel','confirm'],
                btnCls: ['cancel','confirm'],
                confirm: function() {
                    dialog.destroy();
                },
                afterShow: function(){

                }
            });
        });
        $('#btnEdit').on('click',function(){
            var content = '<div class="addDialog"><div class="dialog-item-wrap">' +
                '<div class="dialog-item">' +
                '   <div class="dialog-left must-icon">名称</div>' +
                '   <div class="dialog-right">' +
                '       <input class="dialog-input" placeholder="宁波北路">' +
                '   </div>' +
                '</div>' +
                '</div></div>';
            var dialog = new Dialog(null,{
                title: '标题',
                content: content,
                width: '360',
                needDestroy: true,
                hasBtn: true,
                btnText: ["取消","确定"],
                btnRole: ['cancel','confirm'],
                btnCls: ['cancel','confirm'],
                confirm: function() {
                    dialog.destroy();
                },
                afterShow: function(){

                }
            });
        });

        $(".content-inner-top").on("click",".arrow-first",function(){

            $(".content-list-wrap").hasClass("content-list-wrap-show") ? $(".content-list-wrap").removeClass("content-list-wrap-show") : $(".content-list-wrap").addClass("content-list-wrap-show")

        })
        $(".content-list-change").on("click",".arrow-show1",function(){
          console.log( this )
            $(this).parent().siblings(".content-list-change-content").hasClass("content-list-change-content-show") ? $(this).parent().siblings(".content-list-change-content").removeClass("content-list-change-content-show") : $(this).parent().siblings(".content-list-change-content").addClass("content-list-change-content-show")

        })

        $(".header-content-list").on("click",".arrow-show",function(){

            $(this).parent().siblings(".list-title").hasClass("list-title-show") ? $(this).parent().siblings(".list-title").removeClass("list-title-show") : $(this).parent().siblings(".list-title").addClass("list-title-show");

        })
        var title = $('.js-select');//the element I want to monitor
        var title1 = $('.select2-selection__rendered');
        title.bind('DOMNodeInserted', function(e) {
            $(this).css({'color':'#333'})
        });
        title1.bind('DOMNodeInserted', function(e) {
            $(this).css({'color':'#333'})
        });


        var setting1 = {
            view: {
                addDiyDom: addDiyDom,
                showLine: false

            }
        };
        var setting2 = {
            view: {
                showLine: false

            }
        };
        var zNodes2 = [
            {
                name: "全部"
            },
            {
                name: "中心营业部", open: true,
                children: [
                    {name: "杭州湖墅南路证券营业部 150万元"},
                    {name: "杭州庆春路证券营业部 150万元"}

                ]
            },
            {
                name: "A类营业部", open: true,
                children: [
                    {name: "杭州西大街证券营业部 100万元"},
                    {name: "杭州环城西路证券营业部 100万元"}

                ]
            }
        ];
        var zNodes1 = [
            {
                name: "总金额", open: true,
                children: [
                    {name: "直销部门1",class:"span_1"},
                    {name: "直销部门2"},
                    {name: "中心营业部", open: true,
                        children: [
                            {name: "宁波金融中心营业部"},
                            {name: "慈溪开发大道营业部"},
                            {name: "宁波范江岸路营业部"},
                            {name: "宁波镇海营业部"},
                            {name: "余姚四明西路营业部"}
                        ]
                    },
                    {name: "A级营业部", open: true,
                        children: [
                            {name: "B级营业部1"},
                            {name: "B级营业部2"}
                        ]
                    },
                    {name: "分公司", open: true,
                        children: [
                            {name: "湖州红旗路营业部"},
                            {name: "安吉体育场营业部"},
                            {name: "长兴金陵北路营业部"},
                            {name: "德清中兴南路营业部"},
                            {name: "湖州织里商城西路营业部"}
                        ]
                    },
                    {name: "B级营业部", open: true,
                        children: [
                            {name: "台州解放南路营业部"},
                            {name: "温岭东辉北路营业部"},
                            {name: "玉环广陵路营业部"},
                            {name: "黄岩天长南路营业部"},
                            {name: "临海靖江中路营业部"}
                        ]
                    }

                ]
            }
        ];
        function addDiyDom(treeId, treeNode) {
            var aObj = $("#" + treeNode.tId + "_a");
            if ($("#diyBtn_"+treeNode.tId).length>0) return;
            var editStr = "<span id='diyBtn_space_" +treeNode.tId+ "' > </span>"
                + "<input type='text' class='diyBtn1' id='diyBtn_" + treeNode.tId
                + "' title='"+treeNode.name+"' value='1000' /><span class='txt-centers'>万元</span> <button class='btn  btn-true'   id='diyBtn2_" + treeNode.tId
                + "' style='margin-left: -99px;margin-top: 4px;display: none'>确定</button>" ;
            aObj.append(editStr);

        };
        $.fn.zTree.init($("#ztree-change"), setting1, zNodes1);
        $.fn.zTree.init($("#ztree-change-short"), setting2, zNodes2);

        var title1 = $('.diyBtn1');
        title1.bind('input propertychange', function() {
            $(this).siblings(".btn-true").show()
        });

        $("#ztree-change-short ul li a span").on('mouseover',function(){
            $(this).css({'background':"#ccc"})
        }).on('mouseout',function(){
            $(this).css({'background':"transparent"})
        })

    });

</script>
<div class="page-sales-preview">
    <div class="main-content" >
        <div class="main-content-wrap">
            <div class="main-content-wrap-top">
                <span class="tab-options on">任务分解</span>
                <span class="tab-options tab-options-change">分解规则</span>

            </div>
            <div class="main-content-wrap-list">
                <div class="search-content on">
                    <div class="task-search clearfix">
                        <button class="btn btn-primary btn-simple btn-float-right " id="btn_add" >新增</button>
                        <button class="btn btn-float-right" href="#">搜索</button>
                        <dl class="search-dl">
                            <dd>
          <span>
            <select id="select2" class="diy-select">
                <option selected>选择营业部</option>
                <option value="1">营业部1</option>
                <option value="2">营业部2</option>
            </select>
          </span>
                            </dd>
                        </dl>

                        <input type="text" class="aql-input small-input" placeholder="产品名称">

                        <input type="text" class="aql-input small-input" placeholder="产品代码">

                    </div>
                    <div class="main-table">
                        <table width="100%" cellpadding="0" cellspacing="0" class="data-table table-padding7">
                            <thead>
                            <tr>
                                <th width="10%">序号</th>
                                <th width="15%">产品名称 </th>
                                <th width="15%">产品代码 </th>
                                <th width="15%">总任务量（万元）</th>
                                <th width="30%">任务分解</th>
                                <th width="15%">操作</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td>001</td>
                                <td>产品名称</td>
                                <td>产品代码</td>
                                <td>10000</td>
                                <td class="td-ellipsis"><p class="txt-ellipsis">
                                                            分公司1:1000万元；营业部2:150万元；
                                                            营业部3:100万元；营业部4:80万元；
                                                            营业部5:100万元；营业部6:200万元</p>
                                </td>
                                <td class="text-c">
                                    <a href="javascript:void(0)" class="btn btn-primary btn-small btn-department">修改</a>
                                </td>
                            </tr>
                            <tr class="even">
                                <td>001</td>
                                <td>产品名称</td>
                                <td>产品代码</td>
                                <td>10000</td>
                                <td class="td-ellipsis"><p class="txt-ellipsis">
                                    分公司1:1000万元；营业部2:150万元；
                                    营业部3:100万元；营业部4:80万元；
                                    营业部5:100万元；营业部6:200万元</p>
                                </td>
                                <td class="text-c">
                                    <a href="javascript:void(0)" class="btn btn-primary btn-small btn-department">修改</a>
                                </td>
                            </tr>
                            <tr>
                                <td>001</td>
                                <td>产品名称</td>
                                <td>产品代码</td>
                                <td>10000</td>
                                <td class="td-ellipsis"><p class="txt-ellipsis">
                                    分公司1:1000万元；营业部2:150万元；
                                    营业部3:100万元；营业部4:80万元；
                                    营业部5:100万元；营业部6:200万元</p>
                                </td>
                                <td class="text-c">
                                    <a href="javascript:void(0)" class="btn btn-primary btn-small btn-department">修改</a>
                                </td>
                            </tr>
                            <tr class="even">
                                <td>001</td>
                                <td>产品名称</td>
                                <td>产品代码</td>
                                <td>10000</td>
                                <td class="td-ellipsis"><p class="txt-ellipsis">
                                    分公司1:1000万元；营业部2:150万元；
                                    营业部3:100万元；营业部4:80万元；
                                    营业部5:100万元；营业部6:200万元</p>
                                </td>
                                <td class="text-c">
                                    <a href="javascript:void(0)" class="btn btn-primary btn-small btn-department">修改</a>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    {% include component/pagenav-cf.html %}
                </div>
                <div class="search-content ">
                    <div class="dialog-item-wrap">
                            <p class="col-block" style="padding-left: 0">任务分解规则设置</p>
                            <div class="simple-content-table">
                                <div class="title">
                                    <button class="btn" id="btnAdd">新增</button>
                                    <button class="btn" id="btnEdit">修改</button>
                                    <button class="btn">删除</button>
                                    <button class="btn">升级</button>
                                    <button class="btn">降级</button>
                                    <button class="btn">上移</button>
                                    <button class="btn">下移</button>
                                    <button class="btn">启用</button>
                                </div>
                                <div class="content">
                                    <div id="ztree-change" class="ztree"></div>
                                </div>

                        </div>

                    </div>
                </div>
            </div>

        </div>
    </div>
    <div class="dialog-item-wrap edit-wrap edit-add"  style="display: none" >
        <a class="view-back"> &lt;&lt; 返回</a>
        <div class="dialog-item-border" style="position: relative">
            <div class="dialog-item-box-body dialog-item-box-body-change " >
                <div class="tabs-body">
                    <div class="tabs-content on">

                        <div class="dialog-item">
                            <div class="w50p">
                                <div class="dialog-left">选择产品</div>
                                <div class="dialog-right">
                                    <div class="je-select2-wrap">
                                        <select class="select2 " multiple="multiple">
                                            <option value="1">产品代码+产品名称</option>
                                            <option value="2">222</option>
                                            <option value="3">333</option>
                                            <option value="4">444</option>
                                            <option value="5">555</option>
                                            <option value="6">666</option>
                                        </select>
                                        <i class="icon-select2"></i>
                                    </div>
                                    <span class="tips">(可多选)</span>
                                </div>

                            </div>
                        </div>
                        <div class="dialog-item">
                            <div class="w50p">
                                <div class="dialog-left">总任务</div>
                                <div class="dialog-right">
                                    <input class="dialog-input" placeholder="" value="1000">
                                    <span class="tips">万元</span>
                                </div>
                            </div>
                        </div>
                        <div class="dialog-item">
                            <div class="dialog-left dialog-left-top">预约具体名单</div>
                            <div class="dialog-right">
                                <div class="dialog-right-change">
                                    <div class="left-contents">
                                        <div class="header-search">
                                            <div class="search-box">
                                                <input id="search-input"  class="fill-input small" placeholder="输入查找">
                                                <div class="search-list" style="display: none;">
                                                    <ul class="sug-ul">
                                                        <li value=" 1 ">热门业务1</li>
                                                        <li value=" 2 ">热门业务2</li>
                                                        <li value=" 3 ">热门业务3</li>
                                                    </ul>
                                                </div>
                                            </div>
                                            <script>
                                                $(function () {
                                                    var $searchListWrap = $('.search-list');
                                                    var $searchInput = $('#search-input');
                                                    var data = {
                                                        allSug: ""
                                                    }
                                                    var Func = {};

                                                    $.fn.extend({
                                                        setData: function (array) {
                                                            var $self = $(this);
                                                            $(this).html('');
                                                            if (array.length > 0) {
                                                                array.forEach(function (item) {
                                                                    $self.append('<li value=" ' + item.value + ' "><span>1</span>' + item.name + '</li>');
                                                                });
                                                            }
                                                        }
                                                    });
                                                    Func.getAllSug = function (callback) {
                                                        //模拟ajax 热门推荐
                                                        setTimeout(function () {
                                                            var sugArray = [
                                                                {value: "1", name: "热门业务1"},
                                                                {value: "2", name: "热门业务2"},
                                                                {value: "3", name: "热门业务3"}
                                                            ];
                                                            data.allSug = sugArray;
                                                            callback();
                                                        }, 1000);
                                                    };
                                                    Func.renderList = function () {
                                                        var value = $searchInput.val();
                                                        if (value) {
                                                            //show筛选
                                                            Func.filterSug();
                                                            $searchListWrap.find('ul.sug-ul').setData(Func.filterSug(value));
                                                        } else {
                                                            //showAll
                                                            $searchListWrap.find('ul.sug-ul').setData(data.allSug);
                                                        }
                                                    };
                                                    Func.filterSug = function (val) {
                                                        //筛选
                                                        var returnDataArray = [
                                                            {value: "1", name: "筛选热门业务1"},
                                                            {value: "2", name: "筛选热门业务2"},
                                                            {value: "3", name: "筛选热门业务3"}
                                                        ];
                                                        return returnDataArray;
                                                    };
                                                    Func.searchResult = function () {
                                                        //ajax
                                                        var dataArray = [
                                                            {value: "1", name: "查询业务1"},
                                                            {value: "2", name: "查询业务2"},
                                                            {value: "3", name: "查询业务3"}
                                                        ];
                                                        var $searchResult = $('.search-result');
                                                        $searchResult.find('p span').eq(0).text(val);
                                                        $searchResult.find('p span').eq(1).text(dataArray.length);
                                                        //show
                                                        $searchResult.find('ul').html('');
                                                        dataArray.forEach(function (item) {
                                                            $searchResult.find('ul').append('<li><img src="../images/icon/platform.png" class="icon-arrow">创业板开通</li>');
                                                        })
                                                    };
                                                    //-------------------------------以上为定义一些数据及方法-------------------------------

                                                    //设置历史数据模拟
                                                    Func.getAllSug(Func.renderList);

                                                    //输入框交互
                                                    $searchInput.on('focus', function () {
                                                        Func.renderList();
                                                        $searchListWrap.show();
                                                    }).on('blur', function () {
                                                        $searchListWrap.hide();
                                                    }).on('keyup', function () {
                                                        Func.renderList();
                                                        $searchListWrap.show();
                                                    });

                                                });

                                            </script>
                                        </div>
                                        <div class="header-contents">
                                            <!--<p class="header-contents-title">全部</p>
                                            <div class="header-content-list">
                                                <div class="header-list-top"><i class="arrow-show"></i>中心营业部<i class="icon-add"></i></div>
                                                <ul class="list-title list-title-show">
                                                    <li>杭州湖墅南路证券营业部 150万元 <i class="icon-add"></i></li>
                                                    <li>杭州庆春路证券营业部 150万元 <i class="icon-add"></i></li>
                                                </ul>
                                            </div>
                                            <div class="header-content-list">
                                                <div class="header-list-top"><i class="arrow-show"></i>A类营业部<i class="icon-add"></i></div>
                                                <ul class="list-title list-title-show">
                                                    <li>杭州西大街证券营业部 100万元 <i class="icon-add"></i></li>
                                                    <li>杭州环城西路证券营业部 100万元 <i class="icon-add"></i></li>
                                                </ul>
                                            </div>-->
                                            <div id="ztree-change-short" class="ztree"></div>
                                        </div>
                                    </div>
                                    <div class="center-contents" style="height: 338px">
                                        <div class="center-content-img">
                                            <img src="../../images/caitong/right-grey.png" class="right-blue">
                                        </div>
                                    </div>
                                    <div class="right-contents">
                                         <div class="right-content-top">已选营业部  <span class="list-num">2</span>家</div>
                                         <div class="right-list-wrap">
                                            <ul class="right-list">
                                                <li>杭州湖墅南路证券营业部 150万元 <i class="icon-delect"></i></li>
                                                <li>杭州庆春路证券营业部 150万元 <i class="icon-delect"></i></li>
                                            </ul>
                                        </div>
                                        <div class="right-content-botton">
                                            <p>已选金额：<span class="tips-total">1000</span>万元</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        <div class="button-content page-footer-button-container">
            <button class="btn btn-fill">确定</button>
            <button class="btn btn-gray" id="editBtnCancel1">取消</button>
        </div>
    </div>
    <div class="dialog-item-wrap edit-wrap edit-department" style="display: none"  >
        <a class="view-back"> &lt;&lt; 返回</a>
        <div class="dialog-item-border" style="position: relative">
            <div class="dialog-item-box-body dialog-item-box-body-change " >
                <div class="tabs-body">
                    <div class="tabs-content on">

                        <div class="dialog-item">
                            <div class="w50p">
                                <div class="dialog-left">选择产品</div>
                                <div class="dialog-right">
                                    <span class="tips"> 03875 产品名称1</span>
                                </div>
                            </div>
                        </div>
                        <div class="dialog-item">
                            <div class="w50p">
                                <div class="dialog-left">总任务</div>
                                <div class="dialog-right">
                                    <input class="dialog-input" placeholder="" value="1000">
                                    <span class="tips">万元</span>
                                </div>
                            </div>
                        </div>
                        <div class="dialog-item">
                            <div class="dialog-left dialog-left-top">预约具体名单</div>
                            <div class="dialog-right">
                                <div class="dialog-right-wrap ">
                                 <span class="txt-name">直销部门2</span>
                                 <input class="dialog-input" placeholder="" value="150">
                                 <span class="tips">万元</span>
                             </div>
                                <div class="dialog-right-wrap ">
                                    <span class="txt-name">宁波分公司</span>
                                    <input class="dialog-input" placeholder="" value="150">
                                    <span class="tips">万元</span>
                                </div>
                                <div class="dialog-right-wrap ">
                                    <span class="txt-name">直销部门1</span>
                                    <input class="dialog-input" placeholder="" value="150">
                                    <span class="tips">万元</span>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        <div class="button-content page-footer-button-container">
            <button class="btn btn-fill">确定</button>
            <button class="btn btn-gray" id="editBtnCancel2">取消</button>
        </div>
    </div>

</div>


